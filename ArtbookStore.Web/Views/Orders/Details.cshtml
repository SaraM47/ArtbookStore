@model ArtbookStore.Web.Models.Order

<!-- This view displays the details of a specific order. It shows the order information, including customer, date, status, total amount, and the list of items in the order. The layout is determined based on the user's role (Admin or regular user). -->

@{
    // Choose layout based on role: Admins see the admin layout, customers see the normal site layout.
    Layout = User.IsInRole("Admin") 
        ? "_AdminLayout" 
        : "_Layout";
    ViewData["Title"] = "Order Details";
}

<!-- Page title showing order ID -->
<h1 class="admin-title">Order #@Model.Id</h1>

<!-- Order summary box -->
<div class="admin-box">
    <!-- Customer email (User can be null if not loaded or deleted) -->
    <p><strong>Customer:</strong> @Model.User?.Email</p>
    <!-- Order date formatted for readability -->
    <p><strong>Date:</strong> @Model.CreatedAt.ToString("yyyy-MM-dd HH:mm")</p>
    <!-- Status label with a CSS class based on the status value -->
    <p>
        <strong>Status:</strong>
        <span class="status-badge @Model.Status.ToLower()">
            @Model.Status
        </span>
    </p>
    <!-- Total amount formatted to 2 decimals -->
    <p><strong>Total:</strong> @Model.TotalAmount.ToString("0.00")</p>
</div>

<h2 class="admin-subtitle">Items</h2>

<!-- List all items in this order -->
<div class="admin-box">
    @foreach (var item in Model.OrderItems)
    {
        <p>
            @item.Product?.Title –
            Qty: @item.Quantity –
            @item.UnitPrice.ToString("0.00")
        </p>
    }
</div>

<!-- Navigation differs by role, Admin goes back to admin order list while Customer goes back to their own order history -->
@if (User.IsInRole("Admin"))
{
    <a asp-action="Index" class="admin-view-btn mt-4">
        Back to Orders
    </a>
}
else
{
    <a asp-action="MyOrders" class="admin-view-btn mt-4">
        Back to My Orders
    </a>
}